!function(){function contentLoaded(e,t){var n=!1,a=!0,s=e.document,i=s.documentElement,r=s.addEventListener?"addEventListener":"attachEvent",o=s.addEventListener?"removeEventListener":"detachEvent",c=s.addEventListener?"":"on",_=function(a){("readystatechange"!=a.type||"complete"==s.readyState)&&(("load"==a.type?e:s)[o](c+a.type,_,!1),!n&&(n=!0)&&t.call(e,a.type||a))},d=function(){try{i.doScroll("left")}catch(e){return void setTimeout(d,50)}_("poll")};if("complete"==s.readyState)t.call(e,"lazy");else{if(s.createEventObject&&i.doScroll){try{a=!e.frameElement}catch(p){}a&&d()}s[r](c+"DOMContentLoaded",_,!1),s[r](c+"readystatechange",_,!1),e[r](c+"load",_,!1)}}function init_content_script(win,doc,bg){win=win||window,doc=doc||document,bg=bg||{};var api_enabled=!1,dpext_cnt={mark:"meh_loader",__key:Math.round(1e7*Math.random()).toString(35),init:function(){dpext_cnt.get_scripts(function(e){var t=JSON.parse(win.localStorage.ldr_disabled_libs||"{}"),n=[],a=[];e.length&&dpext_cnt.inj_script("window._ext_ldr_"+dpext_cnt.mark+"=true;");for(var s=0;s<e.length;s++){var i=e[s],r=i[3];(r.run_at?a:n).push(i)}var o=function(e){for(var n=0;n<e.length;n++){var a=e[n];dpext_cnt.is_allow_run(a[1],doc)&&(t[a[2]]||dpext_cnt.inj_script(a[0],a[2],a[3]))}};o(n),contentLoaded(win,function(e){o(a)})})},get_scripts:function(e){if(dpext_browser.opera)opera.extension.addEventListener("message",function(t){var n=t.data||{};n.__key==dpext_cnt.__key&&n.files&&n.files.length>0&&e(n.files),"connected"==n.act&&opera.extension.postMessage({act:"get_scripts",url:doc.location.href,in_frame:dpext_cnt.is_in_frame(doc),__key:dpext_cnt.__key}),n.__key==dpext_cnt.__key&&n.files&&n.api_enabled&&(api_enabled=!0),dpext_api.ready=!0,n.__key==dpext_cnt.__key&&dpext_api.message_handler(n),dpext_api.post_message=function(e){return e=dpext_api.prepare_data(e),opera.extension.postMessage(e),e}},!1);else if(dpext_browser.chrome)chrome.extension.sendRequest({act:"get_scripts",url:doc.location.href,in_frame:dpext_cnt.is_in_frame(doc),__key:dpext_cnt.__key},function(t){t.__key==dpext_cnt.__key&&t.files&&t.api_enabled&&(api_enabled=!0),t.__key==dpext_cnt.__key&&t.files&&t.files.length>0&&e(t.files)}),dpext_api.ready=!0,dpext_api.post_message=function(e){return e=dpext_api.prepare_data(e),chrome.extension.sendRequest(e,function(e){e.__key==dpext_cnt.__key&&dpext_api.message_handler(e)}),e};else if(dpext_browser.safari)dpext_api.ready=!0,safari.self.addEventListener("message",function(t){t.message.__key==dpext_cnt.__key&&t.message.files&&t.message.api_enabled&&(api_enabled=!0),t.message.__key==dpext_cnt.__key&&t.message.files&&t.message.files.length>0&&e(t.message.files),t.message.__key==dpext_cnt.__key&&dpext_api.message_handler(t.message)},!1),safari.self.tab.dispatchMessage("get_scripts",{url:doc.location.href,in_frame:dpext_cnt.is_in_frame(doc),__key:dpext_cnt.__key}),dpext_api.post_message=function(e){return e=dpext_api.prepare_data(e),safari.self.tab.dispatchMessage("extension_api",e),e};else if(dpext_browser.maxthon){var t=window.external.mxGetRuntime();t.post("get_scripts",{url:doc.location.href,in_frame:dpext_cnt.is_in_frame(doc),__key:dpext_cnt.__key}),t.listen("scripts",function(t){t.__key==dpext_cnt.__key&&t.files&&t.api_enabled&&(api_enabled=!0),t.__key==dpext_cnt.__key&&t.files&&t.files.length>0&&e(t.files)}),dpext_api.post_message=function(e){return e=dpext_api.prepare_data(e),t.post("extension_bg_api",e),e},t.listen("extension_api",function(e){e.__key==dpext_cnt.__key&&dpext_api.message_handler(e)}),dpext_api.ready=!0}else bg.get_scripts(doc.location.href,function(t,n){n&&(api_enabled=!0),t&&t.length>0&&setTimeout(function(){e(t)},1)},dpext_cnt.is_in_frame(doc)),dpext_api.post_message=function(e){return e=dpext_api.prepare_data(e),setTimeout(function(){bg.postMessage(e,function(e){e.__key==dpext_cnt.__key&&dpext_api.message_handler(e)})},1),e}},is_func_native:function(e){return!!e&&"function"==(typeof e).toLowerCase()&&(e===Function.prototype||/^\s*function\s*(\b[a-z$_][a-z0-9$_]*\b)*\s*\((|([a-z$_][a-z0-9$_]*)(\s*,\s*[a-z$_][a-z0-9$_]*)*)\)\s*{\s*\[native code\]\s*}\s*$/i.test(String(e)))},check_natives:function(){return dpext_cnt.is_func_native(win.eval)&&dpext_cnt.is_func_native(eval)},is_in_frame:function(e){return(e||document).defaultView.parent!=(e||document).defaultView},is_allow_run:function(e,t){e=e||0;var n=(t||document).defaultView.parent!=(t||document).defaultView;switch(e){case 0:return!0;case 1:return n?!1:!0;case 2:return n?!0:!1;case 3:return!1}return!0},inj_script:function(script,info,opts){opts=opts||{};var ext=(info||".js").split(".").pop();switch(ext){case"js":if(opts.in_sandbox){var code="(function(window,document,api,self){ "+script+" })(win,doc,apis,self_obj);";dpext_cnt.is_func_native(eval)&&eval(code)}else if(dpext_browser.opera)win.eval(script);else{var js=doc.createElement("script");js.type="text/javascript",js.charset="UTF-8",opts.by_src?js.src=script:js.innerHTML=script,js.setAttribute(dpext_cnt.mark,info),doc.getElementsByTagName("head")[0].appendChild(js)}break;case"css":if(opts.by_src)cssNode=document.createElement("link"),cssNode.type="text/css",cssNode.rel="stylesheet",cssNode.setAttribute(dpext_cnt.mark,info),cssNode.href=script,doc.getElementsByTagName("head")[0].appendChild(cssNode);else{var styleElement=doc.createElement("style");styleElement.type="text/css",styleElement.setAttribute(dpext_cnt.mark,info),styleElement.appendChild(doc.createTextNode(script)),doc.getElementsByTagName("head")[0].appendChild(styleElement)}}},init_keys:function(){var e=function(){informer.show(dpext_cnt.mark+" scripts updated",2e3,doc)},t=function(t){if(!t)var t=event;if(t.altKey&&t.ctrlKey)switch(t.keyCode){case 85:dpext_api.req({act:"update_scripts"},function(){e()}),informer.show(dpext_cnt.mark+" run update scripts<br/>(Alt+Ctrl+U)",2e3,doc),dpext_cnt.inj_script("console.log('"+dpext_cnt.mark+" run update scripts (Alt+Ctrl+U)');")}};doc.addEventListener?doc.addEventListener("keydown",t,!1):doc.attachEvent?doc.attachEvent("keydown",t):doc.onkeydown=t}},informer={delay:2e3,show:function(e,t,n){t=t||informer.delay,n=n||document;var a=n.createElement("div");a.setAttribute("style",'position:fixed; z-index:10000; background:rgba(0,0,0,0.7); color:#FFF; padding:10px; width:200px; left:-250px; border-radius:0 15px 15px 0; bottom:5px; box-shadow:0 0 5px #000; text-shadow:0 -1px #000; -webkit-transition: all 200ms linear;-moz-transition: all 200ms linear;-o-transition: all 200ms linear; transition: all 200ms linear;font-family: "tahoma", "arial", "verdana", sans-serif, "Lucida Sans"; font-size: 11px;'),console.log("informer",e),a.innerHTML=e;var s=n.createElement("div");s.innerHTML="&times;",s.setAttribute("style","cursor:pointer; float:right; padding:0px 3px; line-height:16px;font-size: 8pt; font-weight:bold; background:rgba(0,0,0,0.5); border-radius:3px;"),a.insertBefore(s,a.firstChild),n.body.appendChild(a);var i=a.style.left,r=!0,o=function(){r&&(r=!1,a.style.left=i,setTimeout(function(){a.parentNode.removeChild(a)},400))};s.onclick=o,setTimeout(function(){a.style.left="0px"},1),setTimeout(function(){o()},t)}},dpext_api={__key:Math.round(1e7*Math.random()).toString(35),ready:!1,callbacks:{},cid:1,prepare_data:function(e){return e=e||{},e.__key=dpext_cnt.__key,e._req=dpext_api.cid++,e},post_message:function(e){console.log("can't post message to bg process",e)},init:function(e){e=e||window,e.addEventListener("message",dpext_api.on_message,!1)},message_handler:function(e){e=e||{},e&&e._req&&dpext_api.callbacks["cb_"+e._req]&&dpext_api.callbacks["cb_"+e._req](e)},on_message:function(e){var t=e.data;t.act&&t.mark==dpext_cnt.mark&&["get","post","head","ajax","download","check_ext","storage_get","storage_set","statistics_init","statistics_write"].indexOf(t.act)>-1&&dpext_api.req(t,function(e,t){win.postMessage({response:e,sub:t},"*")})},req:function(e,t){if(!api_enabled)return!0;var e=dpext_api.post_message(e);e._sub=e._sub||{};var n=e._req;t&&(dpext_api.callbacks["cb_"+n]=function(a){t(a,e._sub),delete dpext_api.callbacks["cb_"+n]})}},self_obj={},apis={req:function(e,t){var e=dpext_api.post_message(e);e._sub=e._sub||{};var n=e._req;t&&(dpext_api.callbacks["cb_"+n]=function(a){t(a,e._sub),delete dpext_api.callbacks["cb_"+n]})},ajax:{get:function(e,t){apis.req({act:"get",url:e},function(e){t(e.response)})},post:function(e,t,n){apis.req({act:"post",url:e,params:t},function(e){n(e.response)})},head:function(e,t){apis.req({act:"head",url:e},function(e){for(var n=(e.response||"").split(/\r?\n/),a={},s=0;s<n.length;s++){var i=n[s].split(":"),r=i.shift().replace(/^\s+|\s+$/g,""),o=i.join(":").replace(/^\s+|\s+$/g,"");r&&o&&(a[r]=o)}t(a)})}},storage:{get:function(e,t){"[object Array]"===Object.prototype.toString.call(e)?apis.req({act:"storage_get",keys:e},function(e){t(e.values)}):apis.req({act:"storage_get",key:e},function(e){t(e.value)})},set:function(e,t,n){"[object Object]"===Object.prototype.toString.call(e)?(n=t,apis.req({act:"storage_set",values:e},function(){n&&n("ok")})):apis.req({act:"storage_set",key:e,value:t},function(){n&&n("ok")})}}};dpext_cnt.init(),dpext_cnt.init_keys(),dpext_api.init(win)}var dpext_browser={mozilla:function(){try{return window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&null!=Components.interfaces}catch(e){return!1}}(),opera:window.opera&&opera.extension,chrome:window.chrome&&chrome.extension,safari:window.safari&&safari.extension,maxthon:function(){try{return null!=window.external.mxGetRuntime}catch(e){return!1}}()};(dpext_browser.opera||dpext_browser.chrome||dpext_browser.safari||dpext_browser.maxthon)&&init_content_script(window,document),meh_loader_init_content_script=init_content_script}();